<!DOCTYPE html>
<html>

<head>
    <title>üîç N8N Debug Test</title>
    <style>
        body {
            font-family: Arial;
            margin: 20px;
        }

        button {
            background: #4CAF50;
            color: white;
            padding: 10px;
            margin: 5px;
            border: none;
            cursor: pointer;
        }

        .error {
            background: #ffebee;
            padding: 10px;
            margin: 10px 0;
        }

        .success {
            background: #e8f5e8;
            padding: 10px;
            margin: 10px 0;
        }

        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow: auto;
        }
    </style>
</head>

<body>
    <h1>üîç N8N Webhook Debug</h1>

    <button onclick="testSimple()">üì§ Test ƒê∆°n Gi·∫£n</button>
    <button onclick="testFull()">üì§ Test ƒê·∫ßy ƒê·ªß</button>
    <button onclick="testMinimal()">üì§ Test T·ªëi Thi·ªÉu</button>

    <div id="results"></div>

    <script>
        async function testSimple() {
            const data = {
                "to": "phuocthde180577@fpt.edu.vn",
                "userName": "TEST SIMPLE",
                "billId": "BILL_SIMPLE123"
            };
            await sendTest("SIMPLE", data);
        }

        async function testFull() {
            const data = {
                "type": "payment_success",
                "to": "phuocthde180577@fpt.edu.vn",
                "userName": "FULL TEST USER",
                "userPhone": "0123456789",
                "doctorName": "BS. Full Test",
                "appointmentDate": "2025-07-10",
                "appointmentTime": "15:00 - 16:00",
                "serviceName": "Full Test Service",
                "billId": "BILL_FULL123",
                "formattedAmount": "1.000.000 VND",
                "clinicName": "Full Test Clinic",
                "clinicAddress": "123 Full Test Street",
                "clinicPhone": "028-9999-8888"
            };
            await sendTest("FULL", data);
        }

        async function testMinimal() {
            const data = {
                "to": "phuocthde180577@fpt.edu.vn",
                "userName": "MINIMAL"
            };
            await sendTest("MINIMAL", data);
        }

        async function sendTest(testName, data) {
            const resultsDiv = document.getElementById('results');
            const testDiv = document.createElement('div');
            testDiv.innerHTML = `<h3>üß™ ${testName} TEST - ${new Date().toLocaleTimeString()}</h3>`;

            try {
                const response = await fetch('https://kinggg123.app.n8n.cloud/webhook/send-appointment-email', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.text();

                if (response.ok) {
                    testDiv.innerHTML += `
                        <div class="success">
                            ‚úÖ SUCCESS - Status: ${response.status}<br>
                            üìß Email sent to: ${data.to}<br>
                            üìã Data sent:<br>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                            üîÑ Response:<br>
                            <pre>${result}</pre>
                        </div>
                    `;
                } else {
                    testDiv.innerHTML += `
                        <div class="error">
                            ‚ùå ERROR - Status: ${response.status}<br>
                            <pre>${result}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                testDiv.innerHTML += `
                    <div class="error">
                        üö® NETWORK ERROR:<br>
                        <pre>${error.message}</pre>
                    </div>
                `;
            }

            resultsDiv.appendChild(testDiv);
        }
    </script>
</body>

</html>